/*! For license information please see 161.60509684.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkdisorber_docs=self.webpackChunkdisorber_docs||[]).push([[161],{161:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var r=i(6),s=i(949),n=i(380),l=i(91);const a=(0,i(345).A)("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);var o=i(223),c=i(376),d=i(374);function u(e){let{images:t=[]}=e;const{registerWindow:i,toggleWindowVisibility:n,windows:l}=(0,o.$k)(),[a,c]=(0,r.useState)(new Set),u=(0,s.Zp)();return(0,d.jsxs)("div",{className:"p-4 container mx-auto",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8",children:t.map(((e,t)=>(0,d.jsx)(h,{src:e.thumb,alt:e.alt||"",isDirectory:e.isDirectory,directoryId:e.directoryId,thumbnails:e.thumbnails,onClick:()=>((e,t)=>{if(t.isDirectory)return void u(`/gallery/${t.directoryId}`);const r=l[e];if(!r||r.isVisible){if(!a.has(e)){const t=400,r=400,s=Math.max(0,Math.random()*(window.innerWidth-t)),n=Math.max(0,Math.random()*(window.innerHeight-r));i(e,{x:s,y:n,width:t,height:r,onClose:()=>c((t=>{const i=new Set(t);return i.delete(e),i}))}),c((t=>new Set([...t,e])))}}else n(e)})(`gallery-window-${t}`,e)},t)))}),Array.from(a).map((e=>{const i=parseInt(e.split("-").pop()),r=t[i];return r&&!r.isDirectory&&r.full?(0,d.jsx)(p,{id:e,imageUrl:r.full,toggleVisibility:()=>n(e)},e):null}))]})}function h(e){let{src:t,alt:i,isDirectory:r,directoryId:s,thumbnails:a,onClick:o}=e;return r&&a?(0,d.jsxs)(n.P.div,{className:"relative group cursor-pointer overflow-hidden rounded-lg bg-gray-900",whileHover:{scale:1.02},onClick:o,children:[(0,d.jsx)("div",{className:"aspect-square w-full",children:(0,d.jsx)("div",{className:"grid grid-cols-2 gap-2 p-2 h-full",children:a.map(((e,t)=>(0,d.jsx)("div",{className:"aspect-square overflow-hidden",children:(0,d.jsx)("img",{src:e.thumb,alt:e.alt,className:"w-full h-full object-cover"})},t)))})}),(0,d.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,d.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,d.jsx)(l.A,{className:"w-6 h-6 text-white"}),(0,d.jsx)("span",{className:"text-white text-lg font-semibold",children:i})]})})]}):(0,d.jsxs)(n.P.div,{className:"relative group cursor-pointer overflow-hidden rounded-lg",whileHover:{scale:1.02},onClick:o,children:[(0,d.jsx)("img",{src:t,alt:i,className:"w-full h-48 object-cover transition-transform duration-200 group-hover:scale-105"}),(0,d.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)("span",{className:"text-white text-sm",children:"View Full Size"})})})]})}function p(e){let{id:t,imageUrl:i,toggleVisibility:r}=e;return(0,d.jsxs)(c.e,{id:t,className:"bg-gray-800/70 backdrop-blur-lg border border-cyan-500/20 flex-lg shadow-lg",children:[(0,d.jsx)("div",{"data-window-header":!0,className:"flex items-center py-1 px-2 border-b border-gray-700 bg-gray-900 flex-t-lg",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 px-2",children:[(0,d.jsx)(a,{className:"w-4 h-4 text-cyan-500"}),(0,d.jsx)("h2",{className:"text-white font-semibold text-sm truncate max-w-[280px]",children:(e=>{try{const t=e.split("/");return decodeURIComponent(t[t.length-1])}catch(t){return"Image"}})(i)})]})}),(0,d.jsx)("div",{className:"h-full bg-black/10",children:(0,d.jsx)("img",{src:i,alt:"",className:"w-full h-full object-contain"})})]})}var g=i(676);const m={50:"small",300:"medium",1e3:"large"},f=e=>e.flatMap((e=>"gif"===e.type?[e]:e.children?f(e.children):[])),x=4,b=(e,t)=>{const i=e.filter((e=>{const t=w(e.text);return t&&50===t.resolution}));if(i.length<=t)return i;const r=new Set,s=[];for(;s.length<t&&s.length<i.length;){const e=i[Math.floor(Math.random()*i.length)];r.has(e.path)||(r.add(e.path),s.push(e))}return s},v=(e,t)=>!t||(e=>{var t;return(null===(t=e.children)||void 0===t?void 0:t.some((e=>!e.type)))||!1})(e.find((e=>e.id===t))||{children:[]})?e.filter((e=>!e.type&&e.children)).flatMap((e=>{if(t&&1===e.children.length&&!e.children[0].type){const i=e.children[0],r=f([i]),s=b(r,x);return 0===s.length?[]:[{thumbnails:s.map((e=>({thumb:(0,g.getMediaUrl)(e.path),full:(0,g.getMediaUrl)(e.path),alt:e.alt||`${i.text} preview`}))),directoryId:`${t}/${i.id.split("/").pop()}`,directoryName:i.text,isDirectory:!0,alt:i.text}]}const i=f([e]),r=b(i,x);return 0===r.length?[]:[{thumbnails:r.map((t=>({thumb:(0,g.getMediaUrl)(t.path),full:(0,g.getMediaUrl)(t.path),alt:t.alt||`${e.text} preview`}))),directoryId:t?`${t}/${e.id.split("/").pop()}`:e.id,directoryName:e.text,isDirectory:!0,alt:e.text}]})):e.flatMap((e=>{if(e.id===t||e.path&&e.path.startsWith(t+"/")){if("gif"===e.type)return[e];if(e.children)return v(e.children,t)}return e.children?v(e.children,t):[]})),w=e=>{if(!e.endsWith(".gif"))return null;const t=e.replace(".gif",""),i=t.lastIndexOf("-");if(-1===i)return null;const r=parseInt(t.substring(i+1)),s=t.substring(0,i);return isNaN(r)?null:{baseName:s,resolution:r}},y=e=>{const t=e.filter((e=>e.isDirectory));if(t.length>0)return t.map((e=>{var t;return{thumb:null===(t=e.thumbnails[0])||void 0===t?void 0:t.thumb,thumbnails:e.thumbnails,alt:e.alt,isDirectory:!0,directoryId:e.directoryId}}));const i=(e=>{const t={};return e.forEach((e=>{const i=w(e.text);if(!i)return;const{baseName:r,resolution:s}=i;t[r]||(t[r]={variants:{}});const n=m[s]||"custom";t[r].variants[n]={path:e.path,resolution:s}})),t})(e);return Object.entries(i).filter((e=>{let[t,i]=e;return i.variants.medium&&i.variants.large})).map((e=>{let[t,i]=e;return((e,t)=>({thumb:(0,g.getMediaUrl)(t.variants.medium.path),full:(0,g.getMediaUrl)(t.variants.large.path),fullRes:t.variants.custom?(0,g.getMediaUrl)(t.variants.custom.path):(0,g.getMediaUrl)(t.variants.large.path),alt:`${e.replace(/-/g," ")} animation`,title:e.replace(/-/g," "),resolutions:Object.fromEntries(Object.entries(t.variants).map((e=>{let[t,i]=e;return[t,i.resolution]})))}))(t,i)}))},j=()=>{const{"*":e=""}=(0,s.g)(),t=e.replace(/^root\/?/,"").replace(/^\/+|\/+$/g,""),[i,n]=(0,r.useState)([]);return(0,r.useEffect)((()=>{(async()=>{try{const e=await(0,g.scanMediaDirectory)(),i=v(e,t),r=y(i);n(r)}catch(e){console.error("Failed to load gallery images:",e),n([])}})()}),[t]),(0,d.jsx)(o.IF,{children:(0,d.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,d.jsx)(u,{images:i})})})}},223:(e,t,i)=>{i.d(t,{IF:()=>a,$k:()=>l});var r=i(6),s=i(374);i(712);const n=(0,r.createContext)(),l=()=>{const e=(0,r.useContext)(n);if(!e)throw new Error("useWindowContext must be used within a WindowProvider");return e},a=e=>{let{children:t}=e;const[i,l]=(0,r.useState)({}),a={windows:i,registerWindow:(0,r.useCallback)(((e,t)=>{l((i=>i[e]?i:{...i,[e]:{position:t,initialPosition:t,isVisible:!0,zIndex:Object.keys(i).length+1}}))}),[]),updateWindowPosition:(0,r.useCallback)(((e,t)=>{l((i=>({...i,[e]:{...i[e],position:t}})))}),[]),toggleWindowVisibility:(0,r.useCallback)((e=>{l((t=>{var i;return{...t,[e]:{...t[e],isVisible:!(null!==(i=t[e])&&void 0!==i&&i.isVisible)}}}))}),[]),bringToFront:(0,r.useCallback)((e=>{l((t=>{const i=Math.max(...Object.values(t).map((e=>e.zIndex)));return{...t,[e]:{...t[e],zIndex:i+1}}}))}),[])};return(0,s.jsx)(n.Provider,{value:a,children:t})}},376:(e,t,i)=>{i.d(t,{e:()=>p});var r=i(6),s=i(223),n=i(921),l=i(259),a=i(374);const o=e=>{let{children:t,onDragEnd:i}=e;const{scale:r}=(0,n.f)();return(0,a.jsx)(l.Mp,{onDragEnd:i,modifiers:[e=>{let{transform:t}=e;return{...t,x:t.x/r,y:t.y/r}}],children:t})},c="cursor-move",d="cursor-move",u="absolute window-draggable",h=r.memo((e=>{let{id:t,children:i,initialPosition:s,className:o="",dragConstraints:h,windowData:p,registerWindow:g,updateWindowPosition:m,bringToFront:f,toggleWindowVisibility:x}=e;const{scale:b}=(0,n.f)();(0,r.useEffect)((()=>{g(t,s)}),[t,s,g]);const[v,w]=(e=>{const t=r.Children.toArray(e);return[t.find((e=>{var t;return null===(t=e.props)||void 0===t?void 0:t["data-window-header"]})),t.filter((e=>{var t;return!(null!==(t=e.props)&&void 0!==t&&t["data-window-header"])}))]})(i),{setNodeRef:y,attributes:j,listeners:N,style:k,isDragging:M,transform:C}=(e=>{let{id:t,position:i}=e;const{scale:r}=(0,n.f)();return(0,l.PM)({id:t,data:{position:i}})})({id:t,position:p.position});(0,r.useEffect)((()=>{M&&f(t)}),[M,f,t]);const I=`${v.props.className||""} ${M?c:d}`,W=p.position.x,$=p.position.y;return(0,a.jsx)("div",{ref:y,style:{display:p.isVisible?"block":"none",position:"absolute",transform:`translate3d(${W+((null===C||void 0===C?void 0:C.x)||0)}px, ${$+((null===C||void 0===C?void 0:C.y)||0)}px, 0)`,zIndex:p.zIndex,touchAction:"none",...k},className:`${u} ${o}`,onClick:()=>f(t),children:(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("div",{...j,...N,className:`flex-1 ${I}`,children:v.props.children}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),x(t)},className:"text-gray-400 hover:text-white transition-colors w-8 h-8 flex items-center justify-center flex-lg hover:bg-gray-700",children:"\xd7"})]}),(0,a.jsx)("div",{className:"pointer-events-auto",children:w})]})})}));h.displayName="WindowContent";const p=e=>{const{windows:t,registerWindow:i,updateWindowPosition:r,bringToFront:l,toggleWindowVisibility:c}=(0,s.$k)(),d=t[e.id];if(!d)return null;const{scale:u}=(0,n.f)();return(0,a.jsx)(o,{onDragEnd:t=>{if(t.delta){const i={x:d.position.x+t.delta.x,y:d.position.y+t.delta.y};r(e.id,i)}},children:(0,a.jsx)(h,{...e,windowData:d,registerWindow:i,updateWindowPosition:r,bringToFront:l,toggleWindowVisibility:c})})}}}]);
//# sourceMappingURL=161.60509684.chunk.js.map