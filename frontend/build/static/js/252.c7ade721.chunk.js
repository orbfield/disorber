"use strict";(self.webpackChunkdisorber=self.webpackChunkdisorber||[]).push([[252],{252:(e,t,i)=>{i.r(t),i.d(t,{default:()=>W});var r=i(43),s=i(216),n=i(550),l=i(784),a=i(462),o=i(802),c=i(632),d=i(942),u=i(579);const h=e=>{let{children:t,onDragEnd:i}=e;const{scale:r}=(0,c.f)();return(0,u.jsx)(d.Mp,{onDragEnd:i,modifiers:[e=>{let{transform:t}=e;return{...t,x:t.x/r,y:t.y/r}}],children:t})},m="cursor-move",p="cursor-move",g="absolute window-draggable",f=r.memo((e=>{let{id:t,children:i,initialPosition:s,className:n="",dragConstraints:l,windowData:a,registerWindow:o,updateWindowPosition:h,bringToFront:f,toggleWindowVisibility:x}=e;const{scale:y}=(0,c.f)();(0,r.useEffect)((()=>{o(t,s)}),[t,s,o]);const[b,v]=(e=>{const t=r.Children.toArray(e);return[t.find((e=>{var t;return null===(t=e.props)||void 0===t?void 0:t["data-window-header"]})),t.filter((e=>{var t;return!(null!==(t=e.props)&&void 0!==t&&t["data-window-header"])}))]})(i),{setNodeRef:w,attributes:j,listeners:N,style:M,isDragging:$,transform:k}=(e=>{let{id:t,position:i}=e;const{scale:r}=(0,c.f)();return(0,d.PM)({id:t,data:{position:i}})})({id:t,position:a.position});(0,r.useEffect)((()=>{$&&f(t)}),[$,f,t]);const D=`${b.props.className||""} ${$?m:p}`,I=a.position.x,W=a.position.y;return(0,u.jsx)("div",{ref:w,style:{display:a.isVisible?"block":"none",position:"absolute",transform:`translate3d(${I+((null===k||void 0===k?void 0:k.x)||0)}px, ${W+((null===k||void 0===k?void 0:k.y)||0)}px, 0)`,zIndex:a.zIndex,touchAction:"none",...M},className:`${g} ${n}`,onClick:()=>f(t),children:(0,u.jsxs)("div",{className:"h-full",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,u.jsx)("div",{...j,...N,className:`flex-1 ${D}`,children:b.props.children}),(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),x(t)},className:"text-gray-400 hover:text-white transition-colors w-8 h-8 flex items-center justify-center flex-lg hover:bg-gray-700",children:"\xd7"})]}),(0,u.jsx)("div",{className:"pointer-events-auto",children:v})]})})}));f.displayName="WindowContent";const x=e=>{const{windows:t,registerWindow:i,updateWindowPosition:r,bringToFront:s,toggleWindowVisibility:n}=(0,o.$k)(),{scale:l}=(0,c.f)(),a=t[e.id];if(!a)return null;return(0,u.jsx)(h,{onDragEnd:t=>{if(t.delta){const i={x:a.position.x+t.delta.x,y:a.position.y+t.delta.y};r(e.id,i)}},children:(0,u.jsx)(f,{...e,windowData:a,registerWindow:i,updateWindowPosition:r,bringToFront:s,toggleWindowVisibility:n})})};function y(e){let{images:t=[]}=e;const{registerWindow:i,toggleWindowVisibility:n,windows:l}=(0,o.$k)(),[a,c]=(0,r.useState)(new Set),d=(0,s.Zp)();return(0,u.jsxs)("div",{className:"p-4 container mx-auto",children:[(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8",children:t.map(((e,t)=>(0,u.jsx)(b,{src:e.thumb,alt:e.alt||"",isDirectory:e.isDirectory,directoryId:e.directoryId,thumbnails:e.thumbnails,onClick:()=>((e,t)=>{if(t.isDirectory)return void d(`/gallery/${t.directoryId}`);const r=l[e];if(!r||r.isVisible){if(!a.has(e)){const t=400,r=400,s=Math.max(0,Math.random()*(window.innerWidth-t)),n=Math.max(0,Math.random()*(window.innerHeight-r));i(e,{x:s,y:n,width:t,height:r,onClose:()=>c((t=>{const i=new Set(t);return i.delete(e),i}))}),c((t=>new Set([...t,e])))}}else n(e)})(`gallery-window-${t}`,e)},t)))}),Array.from(a).map((e=>{const i=parseInt(e.split("-").pop()),r=t[i];return r&&!r.isDirectory&&r.full?(0,u.jsx)(v,{id:e,imageUrl:r.full,toggleVisibility:()=>n(e)},e):null}))]})}function b(e){let{src:t,alt:i,isDirectory:r,directoryId:s,thumbnails:a,onClick:o}=e;return r&&a?(0,u.jsxs)(n.P.div,{className:"relative group cursor-pointer overflow-hidden rounded-lg bg-gray-900",whileHover:{scale:1.02},onClick:o,children:[(0,u.jsx)("div",{className:"aspect-square w-full",children:(0,u.jsx)("div",{className:"grid grid-cols-2 gap-2 p-2 h-full",children:a.map(((e,t)=>(0,u.jsx)("div",{className:"aspect-square overflow-hidden",children:(0,u.jsx)("img",{src:e.thumb,alt:e.alt,className:"w-full h-full object-cover"})},t)))})}),(0,u.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,u.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,u.jsx)(l.A,{className:"w-6 h-6 text-white"}),(0,u.jsx)("span",{className:"text-white text-lg font-semibold",children:i})]})})]}):(0,u.jsxs)(n.P.div,{className:"relative group cursor-pointer overflow-hidden rounded-lg",whileHover:{scale:1.02},onClick:o,children:[(0,u.jsx)("img",{src:t,alt:i,className:"w-full h-48 object-cover transition-transform duration-200 group-hover:scale-105"}),(0,u.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,u.jsx)("div",{className:"flex items-center gap-2",children:(0,u.jsx)("span",{className:"text-white text-sm",children:"View Full Size"})})})]})}function v(e){let{id:t,imageUrl:i,toggleVisibility:r}=e;return(0,u.jsxs)(x,{id:t,className:"bg-gray-800/70 backdrop-blur-lg border border-cyan-500/20 flex-lg shadow-lg",children:[(0,u.jsx)("div",{"data-window-header":!0,className:"flex items-center py-1 px-2 border-b border-gray-700 bg-gray-900 flex-t-lg",children:(0,u.jsxs)("div",{className:"flex items-center gap-2 px-2",children:[(0,u.jsx)(a.A,{className:"w-4 h-4 text-cyan-500"}),(0,u.jsx)("h2",{className:"text-white font-semibold text-sm truncate max-w-[280px]",children:(e=>{try{const t=e.split("/");return decodeURIComponent(t[t.length-1])}catch(t){return"Image"}})(i)})]})}),(0,u.jsx)("div",{className:"h-full bg-black/10",children:(0,u.jsx)("img",{src:i,alt:"",className:"w-full h-full object-contain"})})]})}var w=i(717);const j={50:"small",300:"medium",1e3:"large"},N=e=>e.flatMap((e=>"gif"===e.type?[e]:e.children?N(e.children):[])),M=4,$=(e,t)=>{const i=e.filter((e=>{const t=D(e.text);return t&&50===t.resolution}));if(i.length<=t)return i;const r=new Set,s=[];for(;s.length<t&&s.length<i.length;){const e=i[Math.floor(Math.random()*i.length)];r.has(e.path)||(r.add(e.path),s.push(e))}return s},k=(e,t)=>!t||(e=>{var t;return(null===(t=e.children)||void 0===t?void 0:t.some((e=>!e.type)))||!1})(e.find((e=>e.id===t))||{children:[]})?e.filter((e=>!e.type&&e.children)).flatMap((e=>{if(t&&1===e.children.length&&!e.children[0].type){const i=e.children[0],r=N([i]),s=$(r,M);return 0===s.length?[]:[{thumbnails:s.map((e=>({thumb:(0,w.getMediaUrl)(e.path),full:(0,w.getMediaUrl)(e.path),alt:e.alt||`${i.text} preview`}))),directoryId:`${t}/${i.id.split("/").pop()}`,directoryName:i.text,isDirectory:!0,alt:i.text}]}const i=N([e]),r=$(i,M);return 0===r.length?[]:[{thumbnails:r.map((t=>({thumb:(0,w.getMediaUrl)(t.path),full:(0,w.getMediaUrl)(t.path),alt:t.alt||`${e.text} preview`}))),directoryId:t?`${t}/${e.id.split("/").pop()}`:e.id,directoryName:e.text,isDirectory:!0,alt:e.text}]})):e.flatMap((e=>{if(e.id===t||e.path&&e.path.startsWith(t+"/")){if("gif"===e.type)return[e];if(e.children)return k(e.children,t)}return e.children?k(e.children,t):[]})),D=e=>{if(!e.endsWith(".gif"))return null;const t=e.replace(".gif",""),i=t.lastIndexOf("-");if(-1===i)return null;const r=parseInt(t.substring(i+1)),s=t.substring(0,i);return isNaN(r)?null:{baseName:s,resolution:r}},I=e=>{const t=e.filter((e=>e.isDirectory));if(t.length>0)return t.map((e=>{var t;return{thumb:null===(t=e.thumbnails[0])||void 0===t?void 0:t.thumb,thumbnails:e.thumbnails,alt:e.alt,isDirectory:!0,directoryId:e.directoryId}}));const i=(e=>{const t={};return e.forEach((e=>{const i=D(e.text);if(!i)return;const{baseName:r,resolution:s}=i;t[r]||(t[r]={variants:{}});const n=j[s]||"custom";t[r].variants[n]={path:e.path,resolution:s}})),t})(e);return Object.entries(i).filter((e=>{let[t,i]=e;return i.variants.medium&&i.variants.large})).map((e=>{let[t,i]=e;return((e,t)=>({thumb:(0,w.getMediaUrl)(t.variants.medium.path),full:(0,w.getMediaUrl)(t.variants.large.path),fullRes:t.variants.custom?(0,w.getMediaUrl)(t.variants.custom.path):(0,w.getMediaUrl)(t.variants.large.path),alt:`${e.replace(/-/g," ")} animation`,title:e.replace(/-/g," "),resolutions:Object.fromEntries(Object.entries(t.variants).map((e=>{let[t,i]=e;return[t,i.resolution]})))}))(t,i)}))},W=()=>{const{"*":e=""}=(0,s.g)(),t=e.replace(/^root\/?/,"").replace(/^\/+|\/+$/g,""),[i,n]=(0,r.useState)([]);return(0,r.useEffect)((()=>{(async()=>{try{const e=await(0,w.scanMediaDirectory)(),i=k(e,t),r=I(i);n(r)}catch(e){console.error("Failed to load gallery images:",e),n([])}})()}),[t]),(0,u.jsx)(o.IF,{children:(0,u.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,u.jsx)(y,{images:i})})})}}}]);
//# sourceMappingURL=252.c7ade721.chunk.js.map